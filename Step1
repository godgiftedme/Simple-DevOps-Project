‚úÖ We now know the truth:
If your other script stays open, but every simplified script closes immediately, that means:

‚úÖ Your working script has an infinite loop or long wait

‚ùå The simplified Step-1 script reaches the end instantly ‚Üí Selenium closes Chrome

‚úÖ There is NO ChromeDriver / Policy issue

‚úÖ We only need to force the script to stay alive exactly like your working script

So we will now build a bullet-proof Step-1 that CANNOT close.


---

‚úÖ ‚úÖ SUPER-SAFE STEP-1 (Browser can NEVER close)

This version cannot exit because it contains a manual block + infinite survival loop.

‚úÖ It opens the Datasight URL
‚úÖ Lets you login manually
‚úÖ Keeps Chrome open permanently
‚úÖ Waits until dashboard loads
‚úÖ Never reaches end ‚Üí browser stays open
‚úÖ Works even if nothing loads
‚úÖ Works even if popup timing changes


---

‚úÖ ‚úÖ COPY‚ÄìPASTE THIS EXACT VERSION

from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
import time

# ===== CONFIG =====
TARGET_URL = "your_datasight_url_here"
CHROMEDRIVER_PATH = r"C:\Users\45k9071\Documents\Selenium\SeleniumDrivers\chromedriver.exe"

# ===== CHROME OPTIONS =====
chrome_options = Options()
chrome_options.add_argument("--start-maximized")

# Anti-detection flags (same as your working script)
chrome_options.add_experimental_option("excludeSwitches", ["enable-automation"])
chrome_options.add_experimental_option("useAutomationExtension", False)
chrome_options.add_argument("--disable-blink-features=AutomationControlled")

service = Service(CHROMEDRIVER_PATH)
driver = webdriver.Chrome(service=service, options=chrome_options)

# ===== OPEN DATASIGHT =====
print("\n‚úÖ Opening Datasight ‚Ä¶")
driver.get(TARGET_URL)
time.sleep(2)

print("\n‚úÖ Please login manually:")
print("   - Enter your email")
print("   - Click Next")
print("   - Complete SSO/MFA")
print("\n‚úÖ The browser will NOT close.")
print("‚úÖ Script will wait for you to confirm login.\n")

# ===== BLOCK SCRIPT UNTIL YOU CONFIRM =====
input("üëâ After dashboard loads, PRESS ENTER here to continue‚Ä¶ ")

print("\n‚úÖ OK ‚Äî You confirmed dashboard is loaded.")
print("‚úÖ STEP-1 complete.\n")

# ===== SURVIVAL LOOP (so browser can NEVER close) =====
print("‚è≥ Keeping browser alive for next steps‚Ä¶")
while True:
    time.sleep(1)


---

‚úÖ ‚úÖ THIS VERSION CANNOT CLOSE, because:

‚úÖ Step 1: input()

The script pauses forever until YOU press ENTER.
So the browser stays open no matter what.

‚úÖ Step 2: infinite while True:

Even after Enter is pressed, the script never ends, so Selenium cannot kill the browser.

‚úÖ This is EXACTLY how your existing working script behaves.
‚úÖ That‚Äôs why your other script stayed open.


---

‚úÖ IMPORTANT

Now test:

1. Run the script


2. Browser opens


3. Enter your email manually


4. Login with Google SSO


5. Wait for dashboard to load


6. Go back to the terminal and press ENTER



Browser must stay open forever.


---

‚úÖ PLEASE CONFIRM

Tell me:

‚úÖ Does the browser stay open with this version?

If yes, then we finally lock Step-1 and I will give you:

‚úÖ Step-2 ‚Üí Click GRAS-CHG level
‚úÖ Step-3 ‚Üí Hover + click the 3-dots
‚úÖ Step-4 ‚Üí Export CSV (Excel)


---

‚úÖ Reply:

‚ÄúBrowser stays open now‚Äù
or
‚ÄúStill closes‚Äù (send screenshot).
